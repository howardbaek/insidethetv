<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.3.1">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Howard Baek">

  
  
  
    
  
  <meta name="description" content="On June 14th, 2018, I participated in a Data Hackathon as part of the REU program at George Mason University.">

  
  <link rel="alternate" hreflang="en-us" href="/post/wine-quality-prediction/">

  


  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.d9a97286e3cbad5765504c93a97229e1.css">

  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-144547576-1', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/wine-quality-prediction/">

  
  
  
  
    
    
  
  <meta property="twitter:card" content="summary">
  
  <meta property="og:site_name" content="Inside the Tidyverse">
  <meta property="og:url" content="/post/wine-quality-prediction/">
  <meta property="og:title" content="2018 REU Wine Quality Prediction with caret | Inside the Tidyverse">
  <meta property="og:description" content="On June 14th, 2018, I participated in a Data Hackathon as part of the REU program at George Mason University."><meta property="og:image" content="/img/icon-192.png">
  <meta property="twitter:image" content="/img/icon-192.png"><meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-06-18T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2019-08-17T10:23:29&#43;09:00">
  

  


  





  <title>2018 REU Wine Quality Prediction with caret | Inside the Tidyverse</title>

</head>


<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" role="textbox" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Inside the Tidyverse</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#talks"><span>Talks</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      
      </ul>
      <ul class="navbar-nav ml-auto">
      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">2018 REU Wine Quality Prediction with caret</h1>

  

  
    



<meta content="2018-06-18 00:00:00 &#43;0000 UTC" itemprop="datePublished">
<meta content="2019-08-17 10:23:29 &#43;0900 &#43;0900" itemprop="dateModified">

<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    <time>Aug 17, 2019</time>
  </span>
  

  

  

  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    <a href="/categories/r/">R</a></span>
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/wine-quality-prediction/&amp;text=2018%20REU%20Wine%20Quality%20Prediction%20with%20caret" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/wine-quality-prediction/&amp;t=2018%20REU%20Wine%20Quality%20Prediction%20with%20caret" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=2018%20REU%20Wine%20Quality%20Prediction%20with%20caret&amp;body=/post/wine-quality-prediction/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/wine-quality-prediction/&amp;title=2018%20REU%20Wine%20Quality%20Prediction%20with%20caret" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=2018%20REU%20Wine%20Quality%20Prediction%20with%20caret%20/post/wine-quality-prediction/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/wine-quality-prediction/&amp;title=2018%20REU%20Wine%20Quality%20Prediction%20with%20caret" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>On June 14th, 2018, I participated in a Data Hackathon as part of the REU program at George Mason University. It was my first ever hackathon and I was excited to finally participate in one. It lasted approximately 4 hours, from 10am to 2pm. Our team, consisting of three undergraduate students, worked with the famous Wine Quality dataset, which is hosted by <a href="https://archive.ics.uci.edu/ml/index.php">University of California Irvine’s Center for Machine Learning and Intelligent Systems</a>. The goal of the hackathon was to accurately predict the Quality variable (“Good”= 1 or “Bad” = 0)</p>
<p><br></p>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<p>I first import the data and observe it.</p>
<pre class="r"><code># Load tidyverse and caret package
library(tidyverse)
library(caret)

# Import training / test data
wine_train &lt;- read_csv(&quot;wine_train.csv&quot;)
wine_test &lt;- read_csv(&quot;wine_test.csv&quot;)</code></pre>
<pre class="r"><code>glimpse(wine_train)</code></pre>
<pre><code>## Observations: 799
## Variables: 12
## $ `fixed acidity`        &lt;dbl&gt; 7.4, 7.8, 7.8, 11.2, 7.4, 7.4, 7.9, 7.3, …
## $ `volatile acidity`     &lt;dbl&gt; 0.700, 0.880, 0.760, 0.280, 0.700, 0.660,…
## $ `citric acid`          &lt;dbl&gt; 0.00, 0.00, 0.04, 0.56, 0.00, 0.00, 0.06,…
## $ `residual sugar`       &lt;dbl&gt; 1.9, 2.6, 2.3, 1.9, 1.9, 1.8, 1.6, 1.2, 2…
## $ chlorides              &lt;dbl&gt; 0.076, 0.098, 0.092, 0.075, 0.076, 0.075,…
## $ `free sulfur dioxide`  &lt;dbl&gt; 11, 25, 15, 17, 11, 13, 15, 15, 9, 17, 15…
## $ `total sulfur dioxide` &lt;dbl&gt; 34, 67, 54, 60, 34, 40, 59, 21, 18, 102, …
## $ density                &lt;dbl&gt; 0.9978, 0.9968, 0.9970, 0.9980, 0.9978, 0…
## $ pH                     &lt;dbl&gt; 3.51, 3.20, 3.26, 3.16, 3.51, 3.51, 3.30,…
## $ sulphates              &lt;dbl&gt; 0.56, 0.68, 0.65, 0.58, 0.56, 0.56, 0.46,…
## $ alcohol                &lt;dbl&gt; 9.4, 9.8, 9.8, 9.8, 9.4, 9.4, 9.4, 10.0, …
## $ Quality                &lt;chr&gt; &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;G&quot;, &quot;B&quot;, &quot;B&quot;, &quot;B&quot;, &quot;G&quot;, &quot;…</code></pre>
<pre class="r"><code>glimpse(wine_test)</code></pre>
<pre><code>## Observations: 800
## Variables: 11
## $ `fixed acidity`        &lt;dbl&gt; 9.4, 7.2, 8.6, 5.1, 7.7, 8.4, 8.2, 8.4, 8…
## $ `volatile acidity`     &lt;dbl&gt; 0.500, 0.610, 0.550, 0.585, 0.560, 0.520,…
## $ `citric acid`          &lt;dbl&gt; 0.34, 0.08, 0.09, 0.00, 0.08, 0.22, 0.40,…
## $ `residual sugar`       &lt;dbl&gt; 3.60, 4.00, 3.30, 1.70, 2.50, 2.70, 2.40,…
## $ chlorides              &lt;dbl&gt; 0.082, 0.082, 0.068, 0.044, 0.114, 0.084,…
## $ `free sulfur dioxide`  &lt;dbl&gt; 5, 26, 8, 14, 14, 4, 4, 4, 4, 4, 4, 4, 7,…
## $ `total sulfur dioxide` &lt;dbl&gt; 14, 108, 17, 86, 46, 18, 10, 10, 10, 12, …
## $ density                &lt;dbl&gt; 0.99870, 0.99641, 0.99735, 0.99264, 0.997…
## $ pH                     &lt;dbl&gt; 3.29, 3.25, 3.23, 3.56, 3.24, 3.26, 3.33,…
## $ sulphates              &lt;dbl&gt; 0.52, 0.51, 0.44, 0.94, 0.66, 0.57, 0.70,…
## $ alcohol                &lt;dbl&gt; 10.7, 9.4, 10.0, 12.9, 9.6, 9.9, 12.8, 12…</code></pre>
<p>Training data has 799 observations and 12 variables, including the target variable, Quality, while the testing data has 800 observations and exactly the same attributes except Quality.</p>
<p><br></p>
</div>
<div id="data-manipulation" class="section level1">
<h1>Data Manipulation</h1>
<pre class="r"><code># Change columns names- Take out single quotations and underscores from names 
names(wine_train) &lt;- gsub(&quot;&#39;&quot;, &#39;&#39;, names(wine_train))
names(wine_train) &lt;- gsub(&quot; &quot;, &quot;_&quot;, names(wine_train))
names(wine_train)</code></pre>
<pre><code>##  [1] &quot;fixed_acidity&quot;        &quot;volatile_acidity&quot;     &quot;citric_acid&quot;         
##  [4] &quot;residual_sugar&quot;       &quot;chlorides&quot;            &quot;free_sulfur_dioxide&quot; 
##  [7] &quot;total_sulfur_dioxide&quot; &quot;density&quot;              &quot;pH&quot;                  
## [10] &quot;sulphates&quot;            &quot;alcohol&quot;              &quot;Quality&quot;</code></pre>
<pre class="r"><code>names(wine_test) &lt;- gsub(&quot;&#39;&quot;, &#39;&#39;, names(wine_test))
names(wine_test) &lt;- gsub(&quot; &quot;, &quot;_&quot;, names(wine_test))
names(wine_test)</code></pre>
<pre><code>##  [1] &quot;fixed_acidity&quot;        &quot;volatile_acidity&quot;     &quot;citric_acid&quot;         
##  [4] &quot;residual_sugar&quot;       &quot;chlorides&quot;            &quot;free_sulfur_dioxide&quot; 
##  [7] &quot;total_sulfur_dioxide&quot; &quot;density&quot;              &quot;pH&quot;                  
## [10] &quot;sulphates&quot;            &quot;alcohol&quot;</code></pre>
<pre class="r"><code># Change values in Quality column: &quot;B&quot; = 0 &amp; &quot;G&quot; = 1
wine_train &lt;- wine_train %&gt;% 
  mutate(Quality = ifelse(Quality == &quot;B&quot;, 0, 1))

# Observe number of 0s and 1s
table(wine_train$Quality)</code></pre>
<pre><code>## 
##   0   1 
## 425 374</code></pre>
<p><br></p>
</div>
<div id="feature-selection" class="section level1">
<h1>Feature Selection</h1>
<p>I first wanted to select the relevant and useful features by means of feature selection in the <a href="https://topepo.github.io/caret/index.html">caret package</a>, a popular R package for statistical machine learning. This tutorial got me started: <a href="https://machinelearningmastery.com/feature-selection-with-the-caret-r-package/" class="uri">https://machinelearningmastery.com/feature-selection-with-the-caret-r-package/</a></p>
<pre class="r"><code># Feature Selection #1
set.seed(7) # Bring me luck
train_cor &lt;- cor(wine_train[, -length(names(wine_train))])

# summarize the correlation matrix
print(train_cor)</code></pre>
<pre><code>##                      fixed_acidity volatile_acidity citric_acid
## fixed_acidity         1.0000000000      -0.30241919  0.69369727
## volatile_acidity     -0.3024191923       1.00000000 -0.54708405
## citric_acid           0.6936972747      -0.54708405  1.00000000
## residual_sugar        0.1732066025      -0.03046016  0.13322604
## chlorides            -0.0003612805      -0.01426396  0.19704211
## free_sulfur_dioxide  -0.1562296716       0.03287532 -0.04284979
## total_sulfur_dioxide -0.2105196234       0.08831363 -0.01356392
## density               0.7293551024      -0.13418708  0.44405907
## pH                   -0.6865541686       0.26154512 -0.56343133
## sulphates             0.1618399522      -0.26807580  0.28944979
## alcohol               0.1261203673      -0.08160458  0.18895405
##                      residual_sugar     chlorides free_sulfur_dioxide
## fixed_acidity            0.17320660 -0.0003612805        -0.156229672
## volatile_acidity        -0.03046016 -0.0142639627         0.032875319
## citric_acid              0.13322604  0.1970421057        -0.042849793
## residual_sugar           1.00000000 -0.0293970980         0.171178339
## chlorides               -0.02939710  1.0000000000         0.001938843
## free_sulfur_dioxide      0.17117834  0.0019388434         1.000000000
## total_sulfur_dioxide     0.14129767  0.0228490477         0.730655240
## density                  0.39166663  0.0754952020        -0.033797520
## pH                      -0.05858156 -0.2466119148         0.086088169
## sulphates                0.02657419  0.4123789331         0.050006477
## alcohol                  0.19244357 -0.1500365030        -0.019738532
##                      total_sulfur_dioxide     density           pH
## fixed_acidity                -0.210519623  0.72935510 -0.686554169
## volatile_acidity              0.088313629 -0.13418708  0.261545116
## citric_acid                  -0.013563916  0.44405907 -0.563431327
## residual_sugar                0.141297672  0.39166663 -0.058581563
## chlorides                     0.022849048  0.07549520 -0.246611915
## free_sulfur_dioxide           0.730655240 -0.03379752  0.086088169
## total_sulfur_dioxide          1.000000000 -0.08564002  0.009654689
## density                      -0.085640019  1.00000000 -0.379103361
## pH                            0.009654689 -0.37910336  1.000000000
## sulphates                     0.054326009  0.13497642 -0.284837597
## alcohol                      -0.112954461 -0.18361374  0.124704335
##                        sulphates     alcohol
## fixed_acidity         0.16183995  0.12612037
## volatile_acidity     -0.26807580 -0.08160458
## citric_acid           0.28944979  0.18895405
## residual_sugar        0.02657419  0.19244357
## chlorides             0.41237893 -0.15003650
## free_sulfur_dioxide   0.05000648 -0.01973853
## total_sulfur_dioxide  0.05432601 -0.11295446
## density               0.13497642 -0.18361374
## pH                   -0.28483760  0.12470433
## sulphates             1.00000000  0.09629489
## alcohol               0.09629489  1.00000000</code></pre>
<pre class="r"><code># find attributes that are highly corrected (ideally &gt;0.75)
high_cor &lt;- findCorrelation(train_cor, cutoff=0.5)

# print indexes of highly correlated attributes
print(high_cor)</code></pre>
<pre><code>## [1] 1 3 7</code></pre>
<ul>
<li>Index 1 = <code>fixed_acidity</code></li>
<li>Index 2 = <code>citric_acid</code></li>
<li>Index 3 = <code>total_sulfur_dioxide</code></li>
</ul>
<p><br></p>
</div>
<div id="model-fitting" class="section level1">
<h1>Model Fitting</h1>
<p>Since <code>fixed_acidity</code>, <code>citric_acid</code> and <code>total_sulfur_dioxide</code> are highly correlated (redundant), I only used one of these features (<code>total_sulfur_dioxide</code>) and disposed of the two redundant ones (<code>fixed_acidity</code>, <code>citric_acid</code>). At this point, I formulated a hypothesis: a model without redundant features performs better than a model with redundant features. Let’s find out if this is true.</p>
<p><em>Since the target variable is binary, I fit a logistic regression.</em></p>
<pre class="r"><code># Logistic Regression
wine_train$Quality &lt;- factor(wine_train$Quality, levels = c(0, 1))
train_log &lt;- createDataPartition(wine_train$Quality, p=0.6, list=FALSE)
training &lt;- wine_train[train_log, ]
testing &lt;- wine_train[ -train_log, ]

# Hypothesis: Try logistic regression with all the predictor variables
mod_log &lt;- train(Quality ~ .,  data=training, method=&quot;glm&quot;, family=&quot;binomial&quot;)

exp(coef(mod_log$finalModel))</code></pre>
<pre><code>##          (Intercept)        fixed_acidity     volatile_acidity 
##         1.864623e+09         1.156801e+00         2.673347e-02 
##          citric_acid       residual_sugar            chlorides 
##         2.471207e-01         8.966535e-01         5.374189e-02 
##  free_sulfur_dioxide total_sulfur_dioxide              density 
##         1.043678e+00         9.709662e-01         3.506618e-14 
##                   pH            sulphates              alcohol 
##         1.598339e+00         1.750577e+01         2.315406e+00</code></pre>
<pre class="r"><code>pred &lt;- predict(mod_log, newdata=testing)
accuracy &lt;- table(pred, testing$Quality)
sum(diag(accuracy))/sum(accuracy)</code></pre>
<pre><code>## [1] 0.7021944</code></pre>
<pre class="r"><code># Hypothesis: Try logistic regression without the redundant variables
# Try logistic regression without highly correlated variables
mod_log_2 &lt;- train(Quality ~ volatile_acidity + residual_sugar + chlorides + free_sulfur_dioxide + total_sulfur_dioxide + density + pH + sulphates + alcohol,  data=training, method=&quot;glm&quot;, family=&quot;binomial&quot;)

pred_2 &lt;- predict(mod_log_2, newdata = testing)
accuracy_2 &lt;- table(pred_2, testing$Quality)
sum(diag(accuracy_2))/sum(accuracy_2)</code></pre>
<pre><code>## [1] 0.6959248</code></pre>
<p>The first hypothesis yields an accuracy rate of 71.5%! while the first hypothesis yields 70.8%!
Apparently, including all the variables yields higher accuracy.</p>
<p><br></p>
</div>
<div id="cross-validation" class="section level1">
<h1>Cross Validation</h1>
<p>At this point, I looked on the tutorial page for the caret package to learn how to cross validate. I learned about <code>trainControl</code>, a function “used to specify the type of resampling”. The parameter, <code>method</code>, specifies <code>repeatedcv</code>, which stands for repeated cross validation.</p>
<pre class="r"><code># Cross validation on the second model where I took out the redundant variables
ctrl &lt;- trainControl(method = &quot;repeatedcv&quot;, repeats = 10)

# Train logistic regression model
mod_log_2_ctrl &lt;- train(Quality ~ volatile_acidity + residual_sugar + chlorides + free_sulfur_dioxide +
                     total_sulfur_dioxide + density + pH + sulphates + alcohol, data=training, 
                     trControl = ctrl, method=&quot;glm&quot;, family=&quot;binomial&quot;)
pred_2_ctrl &lt;- predict(mod_log_2, newdata = testing)
accuracy_2_ctrl &lt;- table(pred_2, testing$Quality)
sum(diag(accuracy_2_ctrl))/sum(accuracy_2_ctrl)</code></pre>
<pre><code>## [1] 0.6959248</code></pre>
<p>I got the same accuracy, which means that I didn’t use cross validation properly…I’ll have to learn more.</p>
<p><br></p>
</div>
<div id="advanced-models" class="section level1">
<h1>Advanced Models</h1>
<p>In an effort to achieve a higher accuracy score, I looked for more accurate and powerful models, such as XgBoost, Random Forests, etc.</p>
<pre class="r"><code># XgBoost -----------------------------------------------------------------
mod_xgboost &lt;- train(Quality ~ ., data=training, 
      trControl = ctrl, method=&quot;xgbTree&quot;, family=&quot;binomial&quot;)
pred_xgboost &lt;- predict(mod_xgboost, newdata = testing)
acc_xgboost &lt;- table(pred_xgboost, testing$Quality)
sum(diag(acc_xgboost))/sum(acc_xgboost)
# 70.8%

# Random Forest-----------------------------------------------------------------
mod_rf &lt;- train(Quality ~ volatile_acidity + residual_sugar + chlorides + free_sulfur_dioxide +
                  total_sulfur_dioxide + density + pH + sulphates + alcohol, data=training, 
                trControl = ctrl, method=&quot;rf&quot;, family=&quot;binomial&quot;)
pred_rf &lt;- predict(mod_rf, newdata = testing)
acc_rf &lt;- table(pred_rf, testing$Quality)
sum(diag(acc_rf)) / sum(acc_rf)
# 80.6% is an improvement!

# Logit Boost-----------------------------------------------------------------
mod_logit &lt;- train(Quality ~ volatile_acidity + residual_sugar + chlorides + free_sulfur_dioxide +
                  total_sulfur_dioxide + density + pH + sulphates + alcohol, data=training, 
                trControl = ctrl, method=&quot;LogitBoost&quot;)
pred_logit &lt;- predict(mod_logit, newdata = testing)
acc_logit &lt;- table(pred_logit, testing$Quality)
sum(diag(acc_logit)) / sum(acc_logit)
# 72.1%

# svmRadial-----------------------------------------------------------------
mod_svm &lt;- train(Quality ~ volatile_acidity + residual_sugar + chlorides + free_sulfur_dioxide +
                     total_sulfur_dioxide + density + pH + sulphates + alcohol, data=training, 
                   trControl = ctrl, method=&quot;svmRadial&quot;)
pred_svm &lt;- predict(mod_svm, newdata = testing)
acc_svm &lt;- table(pred_svm, testing$Quality)
sum(diag(acc_svm)) / sum(acc_svm)
# 75.2%

# LMT-----------------------------------------------------------------
mod_svm_linear &lt;- train(Quality ~ volatile_acidity + residual_sugar + chlorides + free_sulfur_dioxide +
                   total_sulfur_dioxide + density + pH + sulphates + alcohol, data=training, 
                 trControl = ctrl, method=&quot;svmLinearWeights2&quot;)
pred_svm_linear &lt;- predict(mod_svm_linear, newdata = testing)
acc_svm_linear &lt;- table(pred_svm_linear, testing$Quality)
sum(diag(acc_svm_linear)) / sum(acc_svm_linear)</code></pre>
<p><br></p>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>I learned about a totally new field in machine learning. Importantly, is very interesting and motivating since coming up with machine learning models feels like creating and refining a crystal ball that shows the future. In the future, I plan on reading through <a href="https://topepo.github.io/caret/index.html">this comprehensive tutorial of the caret package</a>, take machine learning courses on <a href="www.datacamp.com">DataCamp</a>, and hope to learn from the mistakes I made during this hackathon.</p>
</div>

    </div>

    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/academic/">Academic</a>
  
</div>



    
      








  





  
  
  
    
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    
      
      <img class="portrait mr-3" src="/authors/admin/avatar_huf78b351e2efe79424f0130cd46c3a6d5_529022_250x250_fill_q90_lanczos_center.jpg" itemprop="image" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/">Howard Baek</a></h5>
      <h6 class="card-subtitle">Undergraduate</h6>
      <p class="card-text" itemprop="description">Statistics Major (Mathematics Minor) at the University of Washington. My email is howardba@uw.edu</p>
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="/#contact" >
              <i class="fas fa-envelope"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://twitter.com/howard_baek" target="_blank" rel="noopener">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://github.com/howardbaek" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
      <div class="article-widget">
        <div class="hr-light"></div>
        <h3>Related</h3>
        <ul>
          
          <li><a href="/post/what-does-it-mean-to-do-research/">2018 REU What does it mean to do research?</a></li>
          
        </ul>
      </div>
      
    

    

    


  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
      

      
      
    

    
    

    
    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.f1a21f988a77cdbdeeb2f60c710009d1.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    <a href="/privacy/">Privacy Policy</a>
  </p>
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
